<html>

<head>
	<title>PostMonitor</title>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/dygraph/1.1.1/dygraph-combined.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.11.2/lodash.min.js"></script>
</head>

<body>
<div id="graph"></div><br>
<div id="legend"></div>

<script type="text/javascript">
$(function() {
	showProjectDataFromHash();

	$(window).bind('hashchange', function(a,b,c) {
		showProjectDataFromHash();
	});
});

showProjectDataFromHash = function() {
	showProjectData(window.location.hash.substr(1));
};

showProjectData = function(project) {
	$.ajax({url: "http://localhost:8080/projects/"+project, dataType: "json",})
	.done(function(data) {
		var values = data['values'];
		var labels = data['labels'];

		d = _(values)
			.map(function(a) {a[0] = new Date(a[0]); return a;})
			.value();

		g = new Dygraph(document.getElementById("graph"),
			values, 
			{
				labels: labels, 
				connectSeparatedPoints: true,
				labelsDiv: 'legend',
				labelsSeparateLines: true,
				hideOverlayOnMouseOut: false,
				//logscale: true
			}
		);
	});
};
</script>

</body>

</html>